!function(n){angular.module("app",["weatherApp","clockApp","geolocation"])}(window),function(n){angular.module("geolocation",[])}(window),function(n){var t=angular.module("geolocation");t.factory("geolocationService",["$q","$http",function(n,t){function e(n){var t,e,o,r;return"-"==n.charAt(0)?(e="-",t=n.slice(1).split(".")):(e="+",t=n.split(".")),o=t[0],r=t[1],"50"==r&&(r="30"),o.length<2&&(o="0"+o),r.length<2&&(r+="0"),e+o+r}var o=function(){var t=n.defer();return navigator.geolocation?navigator.geolocation.getCurrentPosition(function(n){t.resolve(n.coords)},function(n){t.reject(n)}):t.reject(!1),t.promise},r=function(o,r){var a="a7ca14d429ae359cdab7761182aab",i={url:"http://api.worldweatheronline.com/free/v2/tz.ashx",method:"jsonp",params:{q:o+","+r,format:"json",key:a,callback:"JSON_CALLBACK"}},c=n.defer();return t.jsonp(i.url,i).then(function(n){var t=n.data.data.time_zone[0].utcOffset,o=e(t);c.resolve(o)},function(n){console.dir(n),c.reject(n)}),c.promise};return{getLocation:o,getLocalTime:r}}])}(window),function(n){angular.module("clockApp",[])}(window),function(n){var t=angular.module("clockApp");t.directive("clock",["$interval","dateFilter",function(n,t){return{restricted:"E",scope:{format:"@?"},link:function(e,o,r){function a(){o.text(t(new Date,e.format,r.timezone))}void 0==e.format&&(e.format="h:mm a");var i;o.on("$destroy",function(){n.cancel(i)}),i=n(function(){a()},1e3),a()}}}])}(window),function(n){angular.module("weatherApp",["geolocation"])}(window),function(n){var t=angular.module("weatherApp");t.controller("WeatherCtrl",["weatherSrvc","geolocationService",function(n,t){function e(){t.getLocation().then(function(n){var t=n.latitude,e=n.longitude;a.searchByCoord(t,e)},function(n){a.searchByCity(i)})}function o(n,e){t.getLocalTime(n,e).then(function(n){a.timezone=n},function(n){console.dir(n)})}function r(n){a.currentCity=n.city.name,a.currentWeather=n.main,a.currentTemp=n.temp}var a=this;a.timezone="";var i="Chicago";a.searchByCity=function(t){a.newCity="",n.getWeatherByCity(t).then(function(n){r(n),o(n.city.lat,n.city.lon)},function(n){console.dir(n)})},a.searchByCoord=function(t,e){n.getWeatherByCoord(t,e).then(function(n){r(n),o(t,e)},function(n){console.dir(n)})},e()}])}(window),function(n){var t=angular.module("weatherApp");t.filter("temperature",function(){return function(n){if(n){n=parseInt(n);var t=Math.round((n-32)*(5/9)),e=n+"°F / "+t+"°C";return e}return""}})}(window),function(n){var t=angular.module("weatherApp");t.factory("weatherSrvc",["$http","$q",function(n,t){function e(e){var o=t.defer(),r={};return n.jsonp(e.url,e).then(function(n){var t=n.data;t?(r.city={name:t.name,lat:t.coord.lat,lon:t.coord.lon},t.weather[0]&&(r.main=t.weather[0].main),t.main&&(r.temp=t.main.temp)):console.log("no data"),o.resolve(r)},function(n){console.dir(n),o.reject(n)}),o.promise}var o="http://api.openweathermap.org/data/2.5/weather",r="a0d7e44cdb26abb996246b544a26f161",a=function(n,t){var a={method:"jsonp",url:o,params:{lat:n,lon:t,units:"imperial",APPID:r,callback:"JSON_CALLBACK"}};return e(a)},i=function(n){var t={method:"jsonp",url:o,params:{q:n,units:"imperial",APPID:r,callback:"JSON_CALLBACK"}};return e(t)};return{getWeatherByCity:i,getWeatherByCoord:a}}])}(window);